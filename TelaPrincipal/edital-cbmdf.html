<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plano de Estudos - CBMDF</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHySURBVDhPpZJPSBRhFMd/d2Z3dnV13TUF8SoaCSpoECoZ6qFAT0EPRQ8Fk0IliEihkkKgBEUohB4KlfRQBKGHCpGoQ6EgHcdK6FpRz85835md2f2YfXrHx/s93/v+7/de+H+YpnEC2d0yWCo5zKj2OD4VAdnVQB+dFBCkY2n5bW4BztbU1c/Pz8/b29vPSkpqf2dnd3d3b2hoCJaQngCMTQC8tLS0sLGxsbW1tba2tjaHBwYnJvY/XVtZWVlZWlpSWloK4+L/AQAjE8BfAFpaWhofHz87Ozs/Pz83Nzc7W1swODDAwMDAgIGBsbExYdF/APBDLwDwsbGxsbGxsbW15eXl5e3t7ePj4+vr6+7u7uLiYmNjY29v7+zs7Nra2tLS0vj4+PDw8Ozs7O3t7ezs7M/Pz8zMzMvLw+fn5+Hh4evr6+Xl5d3d3bW1tQkJCZGRkcnJyWlpaZGRkeXl5QkJCcnJyakpqampKSsrm5ubW1tbKysoHBwcfHx/f39/v7+/j4+P7+/v39/cfHx+fn58fHh4eHh5+fn4eHh7u7u7e3t7a2trm5ubKysru7u7a2trm5uY/MjKysrKysrIyPz8/MzMzPz//+PHj+7s7d85c27179+7du1//vXv3rplzP/744/f7+R01cbA8b4Vj+kS+0JzfYmJioqKi4uPj7e3t7e/v7+/vf3p6evv58+fT09Pe3t7m5ubY2NjS0tLi4uLi4uKqqqrk5ORkZGS4uLiYmJj8+/fv39/f39/f7+/v7+/v7e3t7e3t7e3t7e3t7e3t7e0dHR1dXV37+/tra2v39/d3d3dXV1c3Nzc3NzcXFxcXFxcnJyZKSknJyckpKSkpKSlxcXFxcXFxcXFxcXJyanJyamJyYjIyMsbExNTU1OTk5PT09Pz8/OTk5LS0tLS0tKysrKysrKysrLS3t6OioqKiorq6ur6+voKCgoaGhubm5ra2tqampnZ2dpqamsbGxpaWlqampmZmZlZWVmZmZmZmZnZ2dna2tra2tra2trampmZmZmZmZmZmZmZmZmZmZubl/AsgW+gAAAABJRU5ErkJggg==">

    <style>
        /* --- APPLE DESIGN PHILOSOPHY - RESET & GLOBAIS --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
            background-color: #000000;
            color: #f5f5f7;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* --- LAYOUT PRINCIPAL - GRID E ESPAÇAMENTO --- */
        .dashboard-container {
            display: grid;
            grid-template-columns: 240px 1fr 340px;
            height: 100vh;
            gap: 24px;
            padding: 20px;
        }

        /* --- BARRA LATERAL (SIDEBAR) --- */
        .sidebar {
            padding: 10px 0;
            display: flex;
            flex-direction: column;
        }

        .sidebar-logo {
            padding: 15px 25px;
            margin-bottom: 10px;
        }

        .sidebar-logo img {
            width: 50px;
        }

        .sidebar-nav ul {
            list-style: none;
            width: 100%;
            padding: 0 15px;
        }

        .sidebar-nav li a {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 20px;
            color: #8a8a8e;
            text-decoration: none;
            padding: 12px 10px;
            border-radius: 8px;
            transition: all 0.2s ease-in-out;
        }

        .sidebar-nav li a i {
            font-size: 1.2em;
            width: 25px;
            text-align: center;
        }

        .sidebar-nav li a span {
            font-size: 1em;
            font-weight: 500;
        }

        .sidebar-nav li.active a,
        .sidebar-nav li a:hover {
            color: #ffffff;
            background-color: #2c2c2e;
        }

        /* --- CONTEÚDO PRINCIPAL E COLUNA DIREITA --- */
        .main-content,
        .right-column {
            overflow-y: auto;
        }

        .main-content::-webkit-scrollbar {
            width: 8px;
        }

        .main-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .main-content::-webkit-scrollbar-thumb {
            background: #3a3a3c;
            border-radius: 4px;
        }

        .right-column {
            background-color: #1c1c1e;
            border-radius: 16px;
            padding: 25px;
        }

        .right-column::-webkit-scrollbar {
            display: none;
        }

        .page-header {
            margin-bottom: 30px;
        }

        .page-header h1 {
            font-size: 2.2em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .page-header p {
            color: #8a8a8e;
            font-size: 1.1em;
        }

        /* --- PAINEL DE PROGRESSO --- */
        .progress-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .chart-container {
            background-color: #1c1c1e;
            padding: 20px;
            border-radius: 16px;
        }

        .chart-container h4 {
            margin-bottom: 15px;
            font-size: 0.9em;
            font-weight: 500;
            color: #8a8a8e;
        }

        .overall-chart h4 {
            font-size: 1.1em;
            color: #f5f5f7;
            font-weight: 600;
        }

        .progress-bar-container {
            background-color: #2c2c2e;
            border-radius: 5px;
            height: 10px;
            width: 100%;
            overflow: hidden;
        }

        .progress-bar {
            background-color: #ff453a;
            height: 100%;
            border-radius: 5px;
            width: 0%;
            transition: width 0.5s ease-in-out;
        }

        .overall-chart .progress-bar {
            background: linear-gradient(90deg, #ff453a, #ff9f0a);
        }

        .progress-label {
            display: block;
            text-align: right;
            font-size: 0.9em;
            font-weight: 600;
            margin-top: 8px;
        }

        /* --- PLANO DE ESTUDOS (ACORDEÃO) --- */
        .plan-container h2 {
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .accordion-item {
            background-color: #1c1c1e;
            border-radius: 16px;
            margin-bottom: 12px;
            overflow: hidden;
            border: 1px solid transparent;
            transition: border-color 0.3s;
        }

        .accordion-item.active {
            border-color: #3a3a3c;
        }

        .accordion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .accordion-header:hover {
            background-color: #252527;
        }

        .accordion-header h3 {
            font-size: 1.2em;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .progress-label-semana {
            font-size: 0.8em;
            color: #8a8a8e;
            font-weight: 500;
        }

        .accordion-header .icon {
            transition: transform 0.3s ease;
            color: #8a8a8e;
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease, padding 0.5s ease;
            padding: 0 20px;
        }

        .accordion-item.active .accordion-content {
            max-height: 5000px; /* Aumentado para acomodar mais conteúdo */
            padding: 0 20px 20px;
        }

        .accordion-item.active .accordion-header .icon {
            transform: rotate(45deg);
        }

        .day-plan {
            border-top: 1px solid #3a3a3c;
            padding-top: 20px;
            margin-top: 20px;
        }

        .day-plan:first-child {
            border-top: none;
            margin-top: 0;
        }

        .day-plan h4 {
            margin-bottom: 15px;
            font-weight: 600;
            color: #f5f5f7;
            font-size: 1.1em;
        }

        .day-plan ul {
            list-style: none;
        }

        .topic-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px 5px;
            border-radius: 8px;
            transition: background-color 0.2s;
        }

        .topic-item:hover {
            background-color: #2c2c2e;
        }

        .topic-item label {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            cursor: pointer;
        }

        .topic-item .subject-tag {
            font-size: 0.75em;
            font-weight: 600;
            color: #f5f5f7;
            background-color: #3a3a3c;
            padding: 3px 8px;
            border-radius: 5px;
            margin-top: 5px;
            align-self: flex-start;
        }

        .topic-item input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            flex-shrink: 0;
            width: 22px;
            height: 22px;
            border: 2px solid #3a3a3c;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }

        .topic-item input[type="checkbox"]:hover {
            border-color: #8a8a8e;
        }

        .topic-item input[type="checkbox"]:checked {
            background-color: #34c759;
            border-color: #34c759;
        }

        .topic-item input[type="checkbox"]:checked::before {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: #000;
            font-size: 12px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .topic-item.completed label span:first-child {
            color: #8a8a8e;
            text-decoration: line-through;
        }

        /* --- COLUNA DA DIREITA --- */
        .right-column .widget {
            padding: 0;
            background: none;
        }

        .right-column .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .right-column h2 {
            font-size: 1.5em;
        }

        .right-column #current-date {
            font-size: 0.9em;
            color: #8a8a8e;
        }

        .today-widget,
        .lembretes-widget {
            margin-bottom: 25px;
        }

        .today-widget h4,
        .lembretes-widget h4 {
            margin-bottom: 15px;
            padding-bottom: 10px;
            font-size: 1.1em;
            border-bottom: 1px solid #3a3a3c;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .today-widget ul,
        .lembretes-widget ul {
            list-style: none;
        }

        .today-widget li,
        .lembretes-widget li {
            padding: 12px 5px;
            border-bottom: 1px solid #3a3a3c;
        }

        .today-widget li:last-child,
        .lembretes-widget li:last-child {
            border-bottom: none;
        }

        .today-widget li strong,
        .lembretes-widget li strong {
            font-weight: 500;
            display: block;
            margin-bottom: 4px;
        }

        .today-widget li span,
        .lembretes-widget li span {
            font-size: 0.85em;
            color: #8a8a8e;
        }

        /* --- RESPONSIVIDADE --- */
        @media (max-width: 1200px) {
            .dashboard-container {
                grid-template-columns: 90px 1fr;
                grid-template-areas: "sidebar main";
            }

            .sidebar {
                grid-area: sidebar;
            }

            .main-content {
                grid-area: main;
            }

            .right-column {
                display: none;
            }

            .sidebar-nav li a {
                flex-direction: column;
                gap: 8px;
                justify-content: center;
            }

            .sidebar-nav li a span {
                font-size: 0.7em;
            }

            .sidebar-logo {
                display: none;
            }
        }

        @media (max-width: 768px) {
            body {
                overflow-y: auto;
            }

            .dashboard-container {
                display: flex;
                flex-direction: column;
                height: auto;
                min-height: 100vh;
                padding: 10px 10px 80px 10px;
            }

            .main-content {
                order: 1;
                overflow-y: visible;
                padding-right: 0;
            }

            .right-column {
                display: block;
                order: 2;
                margin-top: 24px;
            }

            .sidebar {
                order: 3;
                flex-direction: row;
                justify-content: space-around;
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 70px;
                padding: 5px 0;
                z-index: 1000;
                background-color: rgba(28, 28, 30, 0.7);
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
                border-top: 1px solid rgba(255, 255, 255, 0.1);
            }

            .sidebar-nav {
                width: 100%;
            }

            .sidebar-nav ul {
                display: flex;
                justify-content: space-around;
                align-items: center;
                width: 100%;
                padding: 0;
            }

            .sidebar-nav li a span {
                display: none;
            }

            .sidebar-nav li a i {
                font-size: 1.6em;
            }

            .sidebar-nav li.active a,
            .sidebar-nav li a:hover {
                background-color: transparent;
                color: #ff453a;
            }
        }
    </style>

</head>

<body>
    <div class="dashboard-container">
        
        <aside class="sidebar">
            <div class="sidebar-user"> <h2>Usuário</h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li> <a href="TelaPrincipal.html">
                            <i class="fa-solid fa-house"></i>
                            <span>Home</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <main class="main-content">
            <header class="page-header">
                <h1>Plano de Estudos - Edital CBMDF 2025</h1>
                <p>Acompanhe seu progresso e mantenha a disciplina para alcançar a aprovação.</p>
            </header>

            <section class="progress-panel" id="progress-panel">
                <div class="chart-container overall-chart">
                    <h4>Progresso Geral do Edital</h4>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="geral-progress-bar"></div>
                    </div>
                    <span class="progress-label" id="geral-progress-label">0%</span>
                </div>
                </section>

            <section class="plan-container">
                <h2>Cronograma de Estudos - 15 Semanas</h2>
                <div id="cronograma-container" class="accordion-container">
                    </div>
            </section>
        </main>

        <aside class="right-column">
            <div class="widget today-widget">
                <div class="section-header">
                    <h2>Meu Dia</h2>
                    <span id="current-date"></span>
                </div>
                <h4><i class="fa-solid fa-bullseye"></i> Estudos de Hoje</h4>
                <ul id="today-list">
                    </ul>
            </div>
            <div class="widget lembretes-widget">
                <h4><i class="fa-solid fa-star"></i> Lembretes Fixos</h4>
                <ul>
                    <li>
                        <strong>Revisão de Sábado</strong>
                        <span>Revisar os tópicos mais difíceis da semana.</span>
                    </li>
                     <li>
                        <strong>Simulado Quinzenal</strong>
                        <span>Resolver um simulado completo aos domingos, a cada duas semanas.</span>
                    </li>
                </ul>
            </div>
        </aside>
    </div>

    <script src="auth.js"></script> 

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DADOS DO EDITAL CBMDF 2025 ---
        const editalCBMDF = {
            'Língua Portuguesa': [
                'Compreensão e interpretação de textos de gêneros variados.',
                'Reconhecimento de tipos e gêneros textuais.',
                'Domínio da ortografia oficial: emprego das letras e da acentuação gráfica.',
                'Mecanismos de coesão textual: referenciação, substituição, repetição, conectores.',
                'Emprego/correlação de tempos e modos verbais.',
                'Estrutura morfossintática: coordenação e subordinação.',
                'Emprego dos sinais de pontuação.',
                'Concordância verbal e nominal.',
                'Emprego do sinal indicativo de crase.',
                'Colocação dos pronomes átonos.',
                'Reescritura de frases e parágrafos: substituição e retextualização.',
                'Correspondência oficial: adequação da linguagem ao tipo de documento.',
                'Correspondência oficial: adequação do formato do texto ao gênero.'
            ],
            'Matemática': [
                'Sistemas de unidades de medidas e transformação.',
                'Sequências numéricas, progressões aritméticas e geométricas.',
                'Geometria analítica: coordenadas, retas, circunferência, elipse, parábola, hipérbole.',
                'Análise combinatória e probabilidade.',
                'Geometria plana e espacial.',
                'Noções de estatística: população, amostra, gráficos, média, mediana, moda.'
            ],
            'Física': [
                'Mecânica: Cinemática, Leis de Newton, trabalho, energia, estática.',
                'Termodinâmica: Calor, temperatura, dilatação, gases, leis da termodinâmica.',
                'Eletromagnetismo: Carga, campo elétrico, corrente, campo magnético, leis.'
            ],
            'Química': [
                'Classificação periódica dos elementos químicos.',
                'Radioatividade: emissões, fissão, fusão, riscos e aplicações.',
                'Ligações químicas: iônica, covalente, metálica, intermoleculares.',
                'Matéria e mudança de estado, separação de misturas.',
                'Gases: Teoria cinética, Leis dos gases, misturas gasosas.',
                'Termoquímica: reações, entalpia, entropia, energia livre.',
                'Eletroquímica: pilhas, eletrólise, corrosão.',
                'Tecnologias associadas à química orgânica.'
            ],
            'Biologia': [
                'Ecologia: Relações tróficas, biomas, ciclos, poluição.',
                'Saúde, higiene e saneamento básico: doenças transmissíveis e imunidade.'
            ],
            'Noções de Informática': [
                'Noções de sistema operacional (Linux e Windows).',
                'Edição de textos, planilhas e apresentações (Microsoft Office e BrOffice).',
                'Conceitos de Internet e intranet; navegadores e correio eletrônico.',
                'Organização e gerenciamento de arquivos, pastas e programas.',
                'Segurança da informação: vírus, pragas virtuais, backup.'
            ],
            'Noções de Agenda Ambiental': [
                'Política Nacional de Mudanças no Clima (Lei 12.187/2009).',
                'Política Nacional de Resíduos Sólidos (Lei 12.305/2010).',
                'Lei Distrital 4.770/2012.',
                'Desenvolvimento Sustentável e Agenda Ambiental (A3P).'
            ],
            'Legislação CBMDF': [
                'Lei nº 7.479/1986 (Estatuto dos Bombeiros-Militares).',
                'Lei nº 8.255/1991 (Organização básica do CBMDF).',
                'Lei nº 12.086/2009 (Militares da PMDF e CBMDF).',
                'Decreto Federal nº 7.163/2010.',
                'Decreto GDF nº 31.817/2010.',
                'Decreto-Lei nº 667/1969 (Reorganiza PM e CBM).',
                'Lei nº 14.751/2023 (Lei Orgânica Nacional PM e CBM).',
                'Lei nº 9.784/99 (Processo administrativo federal).',
                'Lei nº 13.709/2018 (LGPD).',
                'Lei nº 4.949/2012 (Realidade do DF e RIDE).',
                'Lei Orgânica do Distrito Federal.',
                'Lei Complementar nº 840/2011 (Servidores públicos civis do DF).'
            ],
            'Emergência Pré-Hospitalar': [
                'Fundamentos Anatômicos e Fisiológicos.',
                'Primeiros Socorros e Suporte Básico de Vida (SBV).',
                'Emergências Traumáticas.',
                'Tipos de choque, classificação e manejo.',
                'Urgências e Emergências Clínicas.',
                'Saúde Mental e Emergências Psiquiátricas.',
                'Urgências Pediátricas e Obstétricas.',
                'Atendimento em Desastres e Múltiplas Vítimas.'
            ]
        };

        // --- CRONOGRAMA DE ESTUDOS CBMDF (15 SEMANAS) ---
        const cronogramaCBMDF = [
            // Mês 1: Agosto/Setembro
            { semana: 1, dias: [ { dia: "Segunda", topicos: [{ id: "leg1", m: "Legislação CBMDF", t: 0 }, { id: "lp1", m: "Língua Portuguesa", t: 0 }] }, { dia: "Terça", topicos: [{ id: "aph1", m: "Emergência Pré-Hospitalar", t: 0 }, { id: "mat1", m: "Matemática", t: 0 }] }, { dia: "Quarta", topicos: [{ id: "leg2", m: "Legislação CBMDF", t: 1 }, { id: "lp2", m: "Língua Portuguesa", t: 1 }] }, { dia: "Quinta", topicos: [{ id: "aph2", m: "Emergência Pré-Hospitalar", t: 1 }, { id: "fis1", m: "Física", t: 0 }] }, { dia: "Sexta", topicos: [{ id: "info1", m: "Noções de Informática", t: 0 }, { id: "qui1", m: "Química", t: 0 }] }, { dia: "Sábado", topicos: [{ id: "rev1", m: "Revisão", t: "Revisar todos os tópicos da Semana 1" }] } ] },
            { semana: 2, dias: [ { dia: "Segunda", topicos: [{ id: "leg3", m: "Legislação CBMDF", t: 2 }, { id: "lp3", m: "Língua Portuguesa", t: 2 }] }, { dia: "Terça", topicos: [{ id: "aph3", m: "Emergência Pré-Hospitalar", t: 2 }, { id: "mat2", m: "Matemática", t: 1 }] }, { dia: "Quarta", topicos: [{ id: "leg4", m: "Legislação CBMDF", t: 3 }, { id: "lp4", m: "Língua Portuguesa", t: 3 }] }, { dia: "Quinta", topicos: [{ id: "aph4", m: "Emergência Pré-Hospitalar", t: 3 }, { id: "fis2", m: "Física", t: 1 }] }, { dia: "Sexta", topicos: [{ id: "bio1", m: "Biologia", t: 0 }, { id: "qui2", m: "Química", t: 1 }] }, { dia: "Sábado", topicos: [{ id: "rev2", m: "Revisão", t: "Revisar tópicos da semana + 20 questões" }] }, { dia: "Domingo", topicos: [{ id: "sim1", m: "Simulado", t: "Simulado Parcial (Conhecimentos Gerais)" }] } ] },
            { semana: 3, dias: [ { dia: "Segunda", topicos: [{ id: "leg5", m: "Legislação CBMDF", t: 4 }, { id: "lp5", m: "Língua Portuguesa", t: 4 }] }, { dia: "Terça", topicos: [{ id: "aph5", m: "Emergência Pré-Hospitalar", t: 4 }, { id: "mat3", m: "Matemática", t: 2 }] }, { dia: "Quarta", topicos: [{ id: "leg6", m: "Legislação CBMDF", t: 5 }, { id: "lp6", m: "Língua Portuguesa", t: 5 }] }, { dia: "Quinta", topicos: [{ id: "aph6", m: "Emergência Pré-Hospitalar", t: 5 }, { id: "fis3", m: "Física", t: 2 }] }, { dia: "Sexta", topicos: [{ id: "info2", m: "Noções de Informática", t: 1 }, { id: "qui3", m: "Química", t: 2 }] }, { dia: "Sábado", topicos: [{ id: "rev3", m: "Revisão", t: "Revisar todos os tópicos da Semana 3" }] } ] },
            { semana: 4, dias: [ { dia: "Segunda", topicos: [{ id: "leg7", m: "Legislação CBMDF", t: 6 }, { id: "lp7", m: "Língua Portuguesa", t: 6 }] }, { dia: "Terça", topicos: [{ id: "aph7", m: "Emergência Pré-Hospitalar", t: 6 }, { id: "mat4", m: "Matemática", t: 3 }] }, { dia: "Quarta", topicos: [{ id: "leg8", m: "Legislação CBMDF", t: 7 }, { id: "lp8", m: "Língua Portuguesa", t: 7 }] }, { dia: "Quinta", topicos: [{ id: "aph8", m: "Emergência Pré-Hospitalar", t: 7 }, { id: "amb1", m: "Noções de Agenda Ambiental", t: 0 }] }, { dia: "Sexta", topicos: [{ id: "bio2", m: "Biologia", t: 1 }, { id: "qui4", m: "Química", t: 3 }] }, { dia: "Sábado", topicos: [{ id: "rev4", m: "Revisão", t: "Revisar tópicos da semana + 20 questões" }] }, { dia: "Domingo", topicos: [{ id: "sim2", m: "Simulado", t: "Simulado Parcial (Conhecimentos Específicos)" }] } ] },
            // Mês 2: Outubro
            { semana: 5, dias: [ { dia: "Segunda", topicos: [{ id: "leg9", m: "Legislação CBMDF", t: 8 }, { id: "lp9", m: "Língua Portuguesa", t: 8 }] }, { dia: "Terça", topicos: [{ id: "info3", m: "Noções de Informática", t: 2 }, { id: "mat5", m: "Matemática", t: 4 }] }, { dia: "Quarta", topicos: [{ id: "leg10", m: "Legislação CBMDF", t: 9 }, { id: "lp10", m: "Língua Portuguesa", t: 9 }] }, { dia: "Quinta", topicos: [{ id: "amb2", m: "Noções de Agenda Ambiental", t: 1 }, { id: "qui5", m: "Química", t: 4 }] }, { dia: "Sexta", topicos: [{ id: "mat6", m: "Matemática", t: 5 }, { id: "qui6", m: "Química", t: 5 }] }, { dia: "Sábado", topicos: [{ id: "rev5", m: "Revisão", t: "Revisar todos os tópicos da Semana 5" }] } ] },
            { semana: 6, dias: [ { dia: "Segunda", topicos: [{ id: "leg11", m: "Legislação CBMDF", t: 10 }, { id: "lp11", m: "Língua Portuguesa", t: 10 }] }, { dia: "Terça", topicos: [{ id: "info4", m: "Noções de Informática", t: 3 }, { id: "qui7", m: "Química", t: 6 }] }, { dia: "Quarta", topicos: [{ id: "leg12", m: "Legislação CBMDF", t: 11 }, { id: "lp12", m: "Língua Portuguesa", t: 11 }] }, { dia: "Quinta", topicos: [{ id: "amb3", m: "Noções de Agenda Ambiental", t: 2 }, { id: "qui8", m: "Química", t: 7 }] }, { dia: "Sexta", topicos: [{ id: "info5", m: "Noções de Informática", t: 4 }, { id: "amb4", m: "Noções de Agenda Ambiental", t: 3 }] }, { dia: "Sábado", topicos: [{ id: "rev6", m: "Revisão", t: "Revisar tópicos da semana + 30 questões" }] }, { dia: "Domingo", topicos: [{ id: "sim3", m: "Simulado", t: "Simulado Completo (Gerais + Específicos)" }] } ] },
            { semana: 7, dias: [ { dia: "Segunda", topicos: [{ id: "lp13", m: "Língua Portuguesa", t: 12 }, { id: "rev_geral_leg", m: "Revisão", t: "Revisão completa de Legislação CBMDF" }] }, { dia: "Terça", topicos: [{ id: "rev_geral_aph", m: "Revisão", t: "Revisão completa de Emergência Pré-Hospitalar" }] }, { dia: "Quarta", topicos: [{ id: "rev_geral_mat", m: "Revisão", t: "Revisão completa de Matemática" }] }, { dia: "Quinta", topicos: [{ id: "rev_geral_fis_qui", m: "Revisão", t: "Revisão completa de Física e Química" }] }, { dia: "Sexta", topicos: [{ id: "rev_geral_outros", m: "Revisão", t: "Revisão de Biologia, Informática e Agenda Ambiental" }] }, { dia: "Sábado", topicos: [{ id: "rev7", m: "Revisão", t: "Revisar pontos fracos identificados na semana" }] } ] },
            { semana: 8, dias: [ { dia: "Segunda", topicos: [{ id: "q1", m: "Questões", t: "Resolver 30 questões de Legislação CBMDF" }] }, { dia: "Terça", topicos: [{ id: "q2", m: "Questões", t: "Resolver 30 questões de Emergência Pré-Hospitalar" }] }, { dia: "Quarta", topicos: [{ id: "q3", m: "Questões", t: "Resolver 30 questões de Língua Portuguesa" }] }, { dia: "Quinta", topicos: [{ id: "q4", m: "Questões", t: "Resolver 30 questões de Matemática" }] }, { dia: "Sexta", topicos: [{ id: "q5", m: "Questões", t: "Resolver 40 questões de Física, Química e Biologia" }] }, { dia: "Sábado", topicos: [{ id: "rev8", m: "Revisão", t: "Corrigir e revisar as questões da semana" }] }, { dia: "Domingo", topicos: [{ id: "sim4", m: "Simulado", t: "Simulado Completo (Gerais + Específicos)" }] } ] },
            // Mês 3: Novembro
            { semana: 9, dias: [ { dia: "Segunda", topicos: [{ id: "q6", m: "Questões", t: "Bloco de questões - Legislação (foco nos erros)" }] }, { dia: "Terça", topicos: [{ id: "q7", m: "Questões", t: "Bloco de questões - APH (foco nos erros)" }] }, { dia: "Quarta", topicos: [{ id: "q8", m: "Questões", t: "Bloco de questões - Português (foco nos erros)" }] }, { dia: "Quinta", topicos: [{ id: "q9", m: "Questões", t: "Bloco de questões - Exatas (foco nos erros)" }] }, { dia: "Sexta", topicos: [{ id: "q10", m: "Questões", t: "Bloco de questões - Diversas (foco nos erros)" }] }, { dia: "Sábado", topicos: [{ id: "rev9", m: "Revisão", t: "Revisão geral com base nos erros das questões" }] } ] },
            { semana: 10, dias: [ { dia: "Segunda", topicos: [{ id: "rev10_1", m: "Revisão", t: "Releitura de resumos e mapas mentais - Específicas" }] }, { dia: "Terça", topicos: [{ id: "rev10_2", m: "Revisão", t: "Releitura de resumos e mapas mentais - Gerais" }] }, { dia: "Quarta", topicos: [{ id: "q11", m: "Questões", t: "50 questões de Legislação e APH" }] }, { dia: "Quinta", topicos: [{ id: "q12", m: "Questões", t: "50 questões de Português e Matemática" }] }, { dia: "Sexta", topicos: [{ id: "q13", m: "Questões", t: "50 questões de outras matérias" }] }, { dia: "Sábado", topicos: [{ id: "rev10", m: "Revisão", t: "Revisão dos tópicos com mais de 50% de erro" }] }, { dia: "Domingo", topicos: [{ id: "sim5", m: "Simulado", t: "Simulado Completo (Gerais + Específicos)" }] } ] },
            { semana: 11, dias: [ { dia: "Segunda", topicos: [{ id: "rev11_1", m: "Revisão", t: "Revisão de Lei Seca - Legislação CBMDF" }] }, { dia: "Terça", topicos: [{ id: "rev11_2", m: "Revisão", t: "Revisão de Protocolos e Portarias - APH" }] }, { dia: "Quarta", topicos: [{ id: "rev11_3", m: "Revisão", t: "Revisão de Fórmulas - Exatas" }] }, { dia: "Quinta", topicos: [{ id: "rev11_4", m: "Revisão", t: "Revisão de Regras Gramaticais - Português" }] }, { dia: "Sexta", topicos: [{ id: "rev11_5", m: "Revisão", t: "Revisão final de matérias menores" }] }, { dia: "Sábado", topicos: [{ id: "rev11", m: "Revisão", t: "Revisão geral dos pontos mais importantes" }] } ] },
            { semana: 12, dias: [ { dia: "Segunda", topicos: [{ id: "sim6_rev", m: "Revisão", t: "Revisão detalhada do último simulado" }] }, { dia: "Terça", topicos: [{ id: "q14", m: "Questões", t: "Resolver provas antigas do CBMDF/PMDF" }] }, { dia: "Quarta", topicos: [{ id: "q15", m: "Questões", t: "Resolver provas antigas de outros CBMs" }] }, { dia: "Quinta", topicos: [{ id: "rev12_1", m: "Revisão", t: "Revisão de tópicos que caem com frequência" }] }, { dia: "Sexta", topicos: [{ id: "rev12_2", m: "Revisão", t: "Revisão dos flashcards/anotações" }] }, { dia: "Sábado", topicos: [{ id: "rev12", m: "Revisão", t: "Revisão geral dos pontos com maior dificuldade" }] }, { dia: "Domingo", topicos: [{ id: "sim7", m: "Simulado", t: "Simulado Final nº 1" }] } ] },
            { semana: 13, dias: [ { dia: "Segunda", topicos: [{ id: "sim7_rev", m: "Revisão", t: "Revisão detalhada do Simulado Final nº 1" }] }, { dia: "Terça", topicos: [{ id: "rev13_1", m: "Revisão", t: "Revisão de Legislação e APH" }] }, { dia: "Quarta", topicos: [{ id: "rev13_2", m: "Revisão", t: "Revisão de Português e Exatas" }] }, { dia: "Quinta", topicos: [{ id: "rev13_3", m: "Revisão", t: "Revisão das demais matérias" }] }, { dia: "Sexta", topicos: [{ id: "rev13_4", m: "Revisão", t: "Leitura de anotações e planejamento para o simulado" }] }, { dia: "Sábado", topicos: [{ id: "rev13", m: "Revisão", t: "Revisão livre dos pontos que sentir necessidade" }] }, { dia: "Domingo", topicos: [{ id: "sim8", m: "Simulado", t: "Simulado Final nº 2" }] } ] },
            { semana: 14, dias: [ { dia: "Segunda", topicos: [{ id: "sim8_rev", m: "Revisão", t: "Revisão detalhada do Simulado Final nº 2" }] }, { dia: "Terça", topicos: [{ id: "rev14_1", m: "Revisão Final", t: "Revisão geral de Legislação Pertinente ao CBMDF." }] }, { dia: "Quarta", topicos: [{ id: "rev14_2", m: "Revisão Final", t: "Revisão geral de Emergência Pré-Hospitalar." }] }, { dia: "Quinta", topicos: [{ id: "rev14_3", m: "Revisão Final", t: "Revisão geral de Língua Portuguesa." }] }, { dia: "Sexta", topicos: [{ id: "rev14_4", m: "Revisão Final", t: "Revisão geral de Matemática e Física." }] }, { dia: "Sábado", topicos: [{ id: "rev14_5", m: "Revisão Final", t: "Revisão das anotações finais e descanso." }] }, { dia: "Domingo", topicos: [{ id: "descanso1", m: "Descanso", t: "Descanso pré-semana da prova." }] } ] },
            { semana: 15, dias: [ { dia: "Segunda", topicos: [{ id: "rev15_1", m: "Revisão de Véspera", t: "Leitura de pontos-chave e artigos importantes" }] }, { dia: "Terça", topicos: [{ id: "rev15_2", m: "Revisão de Véspera", t: "Leitura de fórmulas e conceitos principais" }] }, { dia: "Quarta", topicos: [{ id: "rev15_3", m: "Revisão de Véspera", t: "Leitura de mapas mentais e resumos" }] }, { dia: "Quinta", topicos: [{ id: "rev15_4", m: "Revisão de Véspera", t: "Revisão leve dos tópicos mais difíceis" }] }, { dia: "Sexta", topicos: [{ id: "rev15_5", m: "Revisão de Véspera", t: "Separar material e documentos para a prova" }] }, { dia: "Sábado", topicos: [{ id: "descanso_final", m: "Descanso Total", t: "Descanse a mente e o corpo. Confie na sua preparação." }] }, { dia: "Domingo", topicos: [{ id: "prova", m: "Dia da Prova", t: "Boa sorte! Dia de colocar todo o esforço em prática." }] } ] },
        ];

        const cronogramaContainer = document.getElementById('cronograma-container');
        const progressPanel = document.getElementById('progress-panel');
        const todayList = document.getElementById('today-list');
        const currentDateEl = document.getElementById('current-date');
        
        // --- INÍCIO DAS MODIFICAÇÕES ---
        const currentUserEmail = getCurrentUserEmail(); // Função do auth.js
        if (!currentUserEmail) {
            console.error("Nenhum usuário logado encontrado.");
            return;
        }

        const progressKey = `studyProgressCBMDF_${currentUserEmail}`; // <-- MODIFICADO

        let progress = JSON.parse(localStorage.getItem(progressKey)) || {}; // <-- MODIFICADO
        let totalTopics = 0;

        function saveProgress() {
            localStorage.setItem(progressKey, JSON.stringify(progress)); // <-- MODIFICADO
        }
        // --- FIM DAS MODIFICAÇÕES ---


        function renderCronograma() {
            cronogramaContainer.innerHTML = '';
            totalTopics = 0;

            cronogramaCBMDF.forEach(semanaData => {
                if (!semanaData.dias || semanaData.dias.length === 0) return;

                const semanaEl = document.createElement('div');
                semanaEl.className = 'accordion-item';

                let semanaTopics = 0;
                let semanaCompleted = 0;

                const contentHtml = semanaData.dias.map(diaData => {
                    const diaTopics = diaData.topicos.map(topic => {
                        let isCountable = typeof topic.t === 'number';

                        if (isCountable) {
                            totalTopics++;
                            semanaTopics++;
                            if (progress[topic.id]) {
                                semanaCompleted++;
                            }
                        }
                        
                        const topicText = isCountable ? editalCBMDF[topic.m][topic.t] : topic.t;
                        const isCompleted = progress[topic.id] ? 'completed' : '';
                        const isChecked = progress[topic.id] ? 'checked' : '';
                        
                        return `<li class="topic-item ${isCompleted}" data-id="${topic.id}"><input type="checkbox" id="${topic.id}" ${isChecked}><label for="${topic.id}"><span>${topicText}</span><span class="subject-tag">${topic.m}</span></label></li>`;
                    }).join('');
                    return `<div class="day-plan"><h4>${diaData.dia}</h4><ul>${diaTopics}</ul></div>`;
                }).join('');
                
                const semanaProgress = semanaTopics > 0 ? Math.round((semanaCompleted / semanaTopics) * 100) : 0;

                semanaEl.innerHTML = `
                    <div class="accordion-header">
                        <h3>Semana ${semanaData.semana} <span class="progress-label-semana">(${semanaProgress}%)</span></h3>
                        <i class="fas fa-plus icon"></i>
                    </div>
                    <div class="accordion-content">${contentHtml}</div>`;

                cronogramaContainer.appendChild(semanaEl);
            });
        }

        function updateCharts() {
            const countableProgress = Object.keys(progress).filter(id => !isNaN(parseInt(id.replace(/[a-zA-Z_]/g, ''), 10)));
            const completedTopics = countableProgress.length;
            
            const overallPercentage = totalTopics > 0 ? Math.round((completedTopics / totalTopics) * 100) : 0;

            document.getElementById('geral-progress-bar').style.width = `${overallPercentage}%`;
            document.getElementById('geral-progress-label').textContent = `${overallPercentage}%`;
            
            const existingCharts = progressPanel.querySelectorAll('.chart-container:not(.overall-chart)');
            existingCharts.forEach(chart => chart.remove());

            Object.keys(editalCBMDF).forEach(materia => {
                let totalMateria = 0, completedMateria = 0;
                cronogramaCBMDF.forEach(s => s.dias && s.dias.forEach(d => d.topicos.forEach(t => {
                    if (t.m === materia && typeof t.t === 'number') {
                        totalMateria++;
                        if (progress[t.id]) completedMateria++;
                    }
                })));

                if (totalMateria > 0) {
                    const materiaPercentage = Math.round((completedMateria / totalMateria) * 100);
                    const chartEl = document.createElement('div');
                    chartEl.className = 'chart-container';
                    chartEl.innerHTML = `<h4>${materia}</h4><div class="progress-bar-container"><div class="progress-bar" style="width: ${materiaPercentage}%;"></div></div><span class="progress-label">${materiaPercentage}%</span>`;
                    progressPanel.appendChild(chartEl);
                }
            });
        }
        
        function renderTodayStudies() {
            const today = new Date();
            const dayOfWeek = today.toLocaleDateString('pt-BR', { weekday: 'long' }).replace(/-feira/i, '').replace(/^\w/, c => c.toUpperCase());
            
            currentDateEl.textContent = today.toLocaleDateString('pt-BR', { day: '2-digit', month: 'long' });
            todayList.innerHTML = '<li>Nenhum estudo agendado para hoje.</li>';
            
            const startDate = new Date('2025-08-18');
            const oneDay = 1000 * 60 * 60 * 24;
            const weekDiff = Math.floor((today - startDate) / (oneDay * 7));

            if (weekDiff >= 0 && weekDiff < cronogramaCBMDF.length) {
                const currentWeek = cronogramaCBMDF[weekDiff];
                if (currentWeek && currentWeek.dias) {
                    const todayPlan = currentWeek.dias.find(d => d.dia === dayOfWeek);
                    if (todayPlan) {
                        todayList.innerHTML = todayPlan.topicos.map(topic => {
                            const topicText = typeof topic.t === 'number' ? editalCBMDF[topic.m][topic.t] : topic.t;
                            return `<li><strong>${topic.m}:</strong> <span>${topicText}</span></li>`
                        }).join('');
                    }
                }
            }
        }

        cronogramaContainer.addEventListener('click', (e) => {
            const header = e.target.closest('.accordion-header');
            if (header) {
                header.parentElement.classList.toggle('active');
                return;
            }

            const checkbox = e.target.closest('input[type="checkbox"]');
            if (checkbox) {
                const id = checkbox.id;
                const topicItem = checkbox.closest('.topic-item');
                if (checkbox.checked) {
                    progress[id] = true;
                    topicItem.classList.add('completed');
                } else {
                    delete progress[id];
                    topicItem.classList.remove('completed');
                }
                saveProgress();
                renderCronograma();
                updateCharts();
            }
        });

        renderCronograma();
        updateCharts();
        renderTodayStudies();
    });
    </script>
</body>
</html>